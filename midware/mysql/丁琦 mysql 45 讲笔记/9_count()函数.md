## mysql 统计行数

最常见的统计行数的函数 `count()`,有许多不同的用法

```
count(字段)
count(主键 id)
count(1)
count(*)
```

首先明确 `count()` 函数的语义,`count()` 是一个 **聚合函数**,对于返回的结果集,一行一行地判断,如果 `count()` 函数的参数不等于 `NULL`,累计值就加 `1`,否则不加,最后返回累计值

上述几种 `count()` 函数的不同参数用法,都表示满足条件的结果集总行数

而 `count(字段)` 稍微特殊一点,它统计的是 `字段 != NULL` 的总行数

* `count(主键)`: InnoDB 会遍历整张表,把每一行的 `id` 都取出来,然后返回到 Server 层,由于主键是不可能为空的,所以 Server 层就按行累加计数
* `count(1)`: InnoDB 遍历整张表,但是不取值返回到 Server 层,对于返回值 Server 层每一行都放一个 `1` 进去,由于放了一个 `1` 自然也不可能为空,最后按行累加计数
* `count(字段)`: 按照 `字段` 统计稍微特殊一点

    1. 如果这个 `字段` 定义为 `NOT NULL`,InnDB 就一行一行地取出这个 `字段`,返回到 Server 层后再判断是否为 `NULL`,最后按行累加
    2. 如果这个 `字段` 定义为 `NULLABLE`,InnoDB 就在取值的时候判断是否等于 `NULL`,如果为 `NULL` 就不取出来,返回到 Server 层后还要再做判断,最后才累加
* `count(*)`: 这个 mysql 专门对此做了特殊的优化,不取值

总的来说,`count(字段)` 由于在 InnoDB 和 Server 层有可能出现判断是否等于 `NULL` 的情况,而 `count(主键 id)` 和 `count(1)` 都涉及到取值,自然也涉及到数据的处理,只有 `count(*)` 专门优化后不需要取值

性能上:
```
count(字段) < count(主键 id) < count(1) ≈ count(*)
```
所以以后都是用 `count(*)` 准没错